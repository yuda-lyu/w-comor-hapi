/*!
 * ht-server v1.0.15
 * (c) 2018-2019 yuda-lyu(semisphere)
 * Released under the MIT License.
 */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@hapi/hapi")):"function"==typeof define&&define.amd?define(["@hapi/hapi"],t):(e=e||self,e["ht-server"]=t(e["@hapi/hapi"]))})(this,function(e){'use strict';function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e,t,o,n,r,a,c){try{var i=e[a](c),l=i.value}catch(e){return void o(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function a(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Se&&Se in Object(e)?_e(e):xe(e)}function c(e){var o=t(e);return null!=e&&("object"==o||"function"==o)}function i(e){return!!Le&&Le in e}function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function p(e){var o=t(e);return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==e:null===e}function d(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function s(e){var t=this.__data__=new ce(e);this.size=t.size}function y(e,t,o){var n=e[t];at.call(e,t)&&oe(n,o)&&(o!==void 0||t in e)||nt(e,t,o)}function u(e){return null!=e&&"object"==t(e)}function h(e,o){var n=t(e);return o=null==o?9007199254740991:o,!!o&&("number"==n||"symbol"!=n&&mt.test(e))&&-1<e&&0==e%1&&e<o}function b(e,t,o,n,r,a){var c,i=1&t,l=2&t;if(o&&(c=r?o(e,n,r,a):o(e)),void 0!==c)return c;if(!Ae(e))return e;var p=ft(e);if(!p){var d=Io(e),s="[object Function]"==d||"[object GeneratorFunction]"==d;if(jt(e))return Yt(e,i);if("[object Object]"!=d&&"[object Arguments]"!=d&&(!s||r)){if(!rn[d])return r?e:{};c=Yo(e,d,i)}else if(c=l||s?{}:Zo(e),!i)return l?so(e,Ht(c,e)):no(e,Ct(c,e))}else if(c=Mo(e),!i)return Xt(e,c);a||(a=new Ke);var y=a.get(e);if(y)return y;a.set(e,c),nn(e)?e.forEach(function(n){c.add(b(n,t,o,n,e,a))}):en(e)&&e.forEach(function(n,r){c.set(r,b(n,t,o,r,e,a))});var u=4&t?l?ho:uo:l?keysIn:Dt,h=p?void 0:u(e);return et(h||e,function(n,r){h&&(r=n,n=e[r]),ct(c,r,b(n,t,o,r,e,a))}),c}function g(e){return"symbol"==t(e)||pt(e)&&we(e)=="[object Symbol]"}function f(e,o){if(ft(e))return!1;var n=t(e);return!!("number"==n||"symbol"==n||"boolean"==n||null==e||cn(e))||pn.test(e)||!ln.test(e)||null!=o&&e in Object(o)}function _(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var o=function o(){var n=arguments,r=t?t.apply(this,n):n[0],a=o.cache;if(a.has(r))return a.get(r);var c=e.apply(this,n);return o.cache=a.set(r,c)||a,c};return o.cache=new(_.Cache||Je),o}function j(e){if("string"==typeof e)return e;if(ft(e))return hn(e,j)+"";if(cn(e))return fn?fn.call(e):"";var t=e+"";return"0"==t&&1/e==-bn?"-0":t}function m(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new Je;++t<o;)this.add(e[t])}function x(e,t,o,n,r,a){var c=1&o,i=uo(e),l=i.length,p=uo(t),d=p.length;if(l!=d&&!c)return!1;for(var s,y=l;y--;)if(s=i[y],c?!(s in t):!Fn.call(t,s))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var h=!0;a.set(e,t),a.set(t,e);for(var b=c;++y<l;){s=i[y];var g=e[s],f=t[s];if(n)var _=c?n(f,g,s,t,e,a):n(g,f,s,e,t,a);if(void 0===_?!(g===f||r(g,f,o,n,a)):!_){h=!1;break}b||(b="constructor"==s)}if(h&&!b){var j=e.constructor,m=t.constructor;j!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof j&&j instanceof j&&"function"==typeof m&&m instanceof m)&&(h=!1)}return a["delete"](e),a["delete"](t),h}function S(e,t,o,n,r){return!(e!==t)||(null!=e&&null!=t&&(pt(e)||pt(t))?Nn(e,t,o,n,S,r):e!==e&&t!==t)}function w(e,t,o,n){var r=o.length,a=r,c=!n;if(null==e)return!a;for(e=Object(e);r--;){var i=o[r];if(c&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++r<a;){i=o[r];var l=i[0],p=e[l],d=i[1];if(!(c&&i[2])){var s=new Ke;if(n)var y=n(p,d,l,e,t,s);if(void 0===y?!Mn(d,p,3,n,s):!y)return!1}else if(void 0===p&&!(l in e))return!1}return!0}function A(e,t){return null!=e&&t in Object(e)}function v(e){return"function"==typeof e?e:null==e?$n:"object"==t(e)?ft(e)?Wn(e[0],e[1]):Cn(e):Yn(e)}function O(){var e,t,o=new Promise(function(){e=arguments[0],t=arguments[1]});return o.resolve=e,o.reject=t,o}function k(e){var t=Object.prototype.toString.call(e);return"[object String]"===t}function L(e){return!!(k(e)&&""!==e)}function E(e){var t=Object.prototype.toString.call(e);return"[object Number]"===t}function P(e){var t=!1;return L(e)?t=!isNaN(+e):E(e)&&(t=!0),t}function T(e){if(!P(e))return 0;var t=fr(e);return t}function z(e){return!!P(e)&&(e=T(e),jr(e))}function F(e){if(!P(e))return 0;e=T(e);var t=wr(e);return"0"===t+""?0:t}function I(e){if(!z(e))return!1;var t=0<F(e);return t}function U(){var e,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:32,o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n=[],a=o.length;if(I(t))for(e=0;e<t;e++)n[e]=o[0|Math.random()*a];else if("rfc4122"===t){n[8]=n[13]=n[18]=n[23]="-",n[14]="4";var c;for(e=0;36>e;e++)n[e]||(c=0|16*Math.random(),n[e]=o[19===e?8|3&c:c])}else return"";var l=n.join("");return l}function N(e){var t=Object.prototype.toString.call(e);return"[object Object]"===t}function M(e,t){return!!N(e)&&!!L(t)&&t in e}function B(e){if(N(e)){for(var t in e)return!0;return!1}return!1}function G(e,t){return B(e)?L(t)?Sn(e,t,""):"":""}function D(e){if(!L(e)&&!P(e))return"";return e+""}function C(e,t){var o=G(e,t);return o=D(o),o}function R(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function V(e){var t=Object.prototype.toString.call(e);return"[object Array]"===t}function W(e){var t=Object.prototype.toString.call(e);return"[object Undefined]"===t}function $(e){var t=Object.prototype.toString.call(e);return"[object Null]"===t}function q(e){if(N(e)){for(var t in e)return!1;return!0}return!1}function H(e){return!!(k(e)&&""===e)}function Y(e){return!!V(e)&&0===e.length}function X(e){return!!W(e)||!!$(e)||!!q(e)||!!H(e)||!!Y(e)}function Q(e){return!!V(e)&&0!==e.length&&!(1===e.length&&X(e[0]))}function Z(e,t){if(L(e))e=[e];else if(Q(e));else return!1;if(L(t))t=[t];else if(Q(t));else return!1;for(var o=0;o<e.length;o++)for(var n=0;n<t.length;n++)if(e[o]===t[n])return!0;return!1}e=e&&e.hasOwnProperty("default")?e["default"]:e;var J="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,K=o(function(e){var o=function(e){function o(e,t,o,n){var a=t&&t.prototype instanceof r?t:r,c=Object.create(a.prototype),i=new u(n||[]);return c._invoke=p(e,o,i),c}function n(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}function r(){}function a(){}function c(){}function i(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function l(e){function o(r,a,c,i){var l=n(e[r],e,a);if("throw"===l.type)i(l.arg);else{var p=l.arg,d=p.value;return d&&"object"===t(d)&&_.call(d,"__await")?Promise.resolve(d.__await).then(function(e){o("next",e,c,i)},function(e){o("throw",e,c,i)}):Promise.resolve(d).then(function(e){p.value=e,c(p)},function(e){return o("throw",e,c,i)})}}function r(e,t){function n(){return new Promise(function(n,r){o(e,t,n,r)})}return a=a?a.then(n,n):n()}var a;this._invoke=r}function p(e,t,o){var r="suspendedStart";return function(a,c){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw c;return b()}for(o.method=a,o.arg=c;;){var i=o.delegate;if(i){var l=d(i,o);if(l){if(l===w)continue;return l}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===r)throw r="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r="executing";var p=n(e,t,o);if("normal"===p.type){if(r=o.done?"completed":"suspendedYield",p.arg===w)continue;return{value:p.arg,done:o.done}}"throw"===p.type&&(r="completed",o.method="throw",o.arg=p.arg)}}}function d(e,t){var o=e.iterator[t.method];if(o===g){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=g,d(e,t),"throw"===t.method))return w;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var r=n(o,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,w;var a=r.arg;if(!a)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w;if(a.done)t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=g);else return a;return t.delegate=null,w}function s(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function u(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(s,this),this.reset(!0)}function h(e){if(e){var t=e[m];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function t(){for(;++o<e.length;)if(_.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=g,t.done=!0,t};return n.next=n}}return{next:b}}function b(){return{value:g,done:!0}}var g,f=Object.prototype,_=f.hasOwnProperty,j="function"==typeof Symbol?Symbol:{},m=j.iterator||"@@iterator",x=j.asyncIterator||"@@asyncIterator",S=j.toStringTag||"@@toStringTag";e.wrap=o;var w={},A={};A[m]=function(){return this};var v=Object.getPrototypeOf,O=v&&v(v(h([])));O&&O!==f&&_.call(O,m)&&(A=O);var k=c.prototype=r.prototype=Object.create(A);return a.prototype=k.constructor=c,c.constructor=a,c[S]=a.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,!(S in e)&&(e[S]="GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},i(l.prototype),l.prototype[x]=function(){return this},e.AsyncIterator=l,e.async=function(t,n,r,a){var c=new l(o(t,n,r,a));return e.isGeneratorFunction(n)?c:c.next().then(function(e){return e.done?e.value:c.next()})},i(k),k[S]="Generator",k[m]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var n=t.pop();if(n in e)return o.value=n,o.done=!1,o}return o.done=!0,o}},e.values=h,u.prototype={constructor:u,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&_.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=g)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return a.type="throw",a.arg=e,o.next=t,n&&(o.method="next",o.arg=g),!!n}if(this.done)throw e;for(var o=this,n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var c=_.call(r,"catchLoc"),l=_.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);}else if(!l)throw new Error("try statement without catch or finally");else if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}},abrupt:function(e,t){for(var o,n=this.tryEntries.length-1;0<=n;--n)if(o=this.tryEntries[n],o.tryLoc<=this.prev&&_.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),y(t),w},catch:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.tryLoc===e){var n=t.completion;if("throw"===n.type){var r=n.arg;y(t)}return r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:h(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=g),w}},e}(e.exports);try{regeneratorRuntime=o}catch(e){Function("r","regeneratorRuntime = r")(o)}}),ee=K,te=function(e){return function(){var t=this,o=arguments;return new Promise(function(r,a){function c(e){n(l,r,a,c,i,"next",e)}function i(e){n(l,r,a,c,i,"throw",e)}var l=e.apply(t,o);c(void 0)})}},oe=function(e,t){return e===t||e!==e&&t!==t},ne=function(e,t){for(var o=e.length;o--;)if(oe(e[o][0],t))return o;return-1},re=Array.prototype,ae=re.splice;r.prototype.clear=function(){this.__data__=[],this.size=0},r.prototype["delete"]=function(e){var t=this.__data__,o=ne(t,e);if(0>o)return!1;var n=t.length-1;return o==n?t.pop():ae.call(t,o,1),--this.size,!0},r.prototype.get=function(e){var t=this.__data__,o=ne(t,e);return 0>o?void 0:t[o][1]},r.prototype.has=function(e){return-1<ne(this.__data__,e)},r.prototype.set=function(e,t){var o=this.__data__,n=ne(o,e);return 0>n?(++this.size,o.push([e,t])):o[n][1]=t,this};var ce=r,ie="object"==t(J)&&J&&J.Object===Object&&J,le=ie,pe="object"==("undefined"==typeof self?"undefined":t(self))&&self&&self.Object===Object&&self,de=le||pe||Function("return this")(),se=de,ye=se.Symbol,ue=ye,he=Object.prototype,be=he.hasOwnProperty,ge=he.toString,fe=ue?ue.toStringTag:void 0,_e=function(e){var t=be.call(e,fe),o=e[fe];try{e[fe]=void 0;var n=!0}catch(t){}var r=ge.call(e);return n&&(t?e[fe]=o:delete e[fe]),r},je=Object.prototype,me=je.toString,xe=function(e){return me.call(e)},Se=ue?ue.toStringTag:void 0,we=a,Ae=c,ve=function(e){if(!Ae(e))return!1;var t=we(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Oe=se["__core-js_shared__"],ke=Oe,Le=function(){var e=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ee=Function.prototype,Pe=Ee.toString,Te=function(e){if(null!=e){try{return Pe.call(e)}catch(t){}try{return e+""}catch(t){}}return""},ze=/[\\^$.*+?()[\]{}|]/g,Fe=/^\[object .+?Constructor\]$/,Ie=Function.prototype,Ue=Object.prototype,Ne=Ie.toString,Me=Ue.hasOwnProperty,Be=RegExp("^"+Ne.call(Me).replace(ze,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ge=function(e){if(!Ae(e)||i(e))return!1;var t=ve(e)?Be:Fe;return t.test(Te(e))},De=function(e,t){return null==e?void 0:e[t]},Ce=function(e,t){var o=De(e,t);return Ge(o)?o:void 0},Re=Ce(se,"Map"),Ve=Re,We=Ce(Object,"create"),$e=We,qe=Object.prototype,He=qe.hasOwnProperty,Ye=Object.prototype,Xe=Ye.hasOwnProperty;l.prototype.clear=function(){this.__data__=$e?$e(null):{},this.size=0},l.prototype["delete"]=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},l.prototype.get=function(e){var t=this.__data__;if($e){var o=t[e];return o==="__lodash_hash_undefined__"?void 0:o}return He.call(t,e)?t[e]:void 0},l.prototype.has=function(e){var t=this.__data__;return $e?t[e]!==void 0:Xe.call(t,e)},l.prototype.set=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=$e&&void 0===t?"__lodash_hash_undefined__":t,this};var Qe=l,Ze=function(e,t){var o=e.__data__;return p(t)?o["string"==typeof t?"string":"hash"]:o.map};d.prototype.clear=function(){this.size=0,this.__data__={hash:new Qe,map:new(Ve||ce),string:new Qe}},d.prototype["delete"]=function(e){var t=Ze(this,e)["delete"](e);return this.size-=t?1:0,t},d.prototype.get=function(e){return Ze(this,e).get(e)},d.prototype.has=function(e){return Ze(this,e).has(e)},d.prototype.set=function(e,t){var o=Ze(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this};var Je=d;s.prototype.clear=function(){this.__data__=new ce,this.size=0},s.prototype["delete"]=function(e){var t=this.__data__,o=t["delete"](e);return this.size=t.size,o},s.prototype.get=function(e){return this.__data__.get(e)},s.prototype.has=function(e){return this.__data__.has(e)},s.prototype.set=function(e,t){var o=this.__data__;if(o instanceof ce){var n=o.__data__;if(!Ve||199>n.length)return n.push([e,t]),this.size=++o.size,this;o=this.__data__=new Je(n)}return o.set(e,t),this.size=o.size,this};var Ke=s,et=function(e,t){for(var o=-1,n=null==e?0:e.length;++o<n&&!(!1===t(e[o],o,e)););return e},tt=function(){try{var e=Ce(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),ot=tt,nt=function(e,t,o){"__proto__"==t&&ot?ot(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o},rt=Object.prototype,at=rt.hasOwnProperty,ct=y,it=function(e,t,o,n){var r=!o;o||(o={});for(var a=-1,c=t.length;++a<c;){var i=t[a],l=n?n(o[i],e[i],i,o,e):void 0;l===void 0&&(l=e[i]),r?nt(o,i,l):ct(o,i,l)}return o},lt=function(e,t){for(var o=-1,n=Array(e);++o<e;)n[o]=t(o);return n},pt=u,dt=function(e){return pt(e)&&we(e)=="[object Arguments]"},st=Object.prototype,yt=st.hasOwnProperty,ut=st.propertyIsEnumerable,ht=dt(function(){return arguments}())?dt:function(e){return pt(e)&&yt.call(e,"callee")&&!ut.call(e,"callee")},bt=ht,gt=Array.isArray,ft=gt,_t=function(){return!1},jt=o(function(e,t){var o=t&&!t.nodeType&&t,n=o&&!0&&e&&!e.nodeType&&e,r=n&&n.exports===o,a=r?se.Buffer:void 0,c=a?a.isBuffer:void 0;e.exports=c||_t}),mt=/^(?:0|[1-9]\d*)$/,xt=h,St=function(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991},wt={};wt["[object Float32Array]"]=wt["[object Float64Array]"]=wt["[object Int8Array]"]=wt["[object Int16Array]"]=wt["[object Int32Array]"]=wt["[object Uint8Array]"]=wt["[object Uint8ClampedArray]"]=wt["[object Uint16Array]"]=wt["[object Uint32Array]"]=!0,wt["[object Arguments]"]=wt["[object Array]"]=wt["[object ArrayBuffer]"]=wt["[object Boolean]"]=wt["[object DataView]"]=wt["[object Date]"]=wt["[object Error]"]=wt["[object Function]"]=wt["[object Map]"]=wt["[object Number]"]=wt["[object Object]"]=wt["[object RegExp]"]=wt["[object Set]"]=wt["[object String]"]=wt["[object WeakMap]"]=!1;var At=function(e){return function(t){return e(t)}},vt=o(function(e,t){var o=t&&!t.nodeType&&t,n=o&&!0&&e&&!e.nodeType&&e,r=n&&n.exports===o,a=r&&le.process,c=function(){try{var e=n&&n.require&&n.require("util").types;return e?e:a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=c}),Ot=vt&&vt.isTypedArray,kt=Ot?At(Ot):function(e){return pt(e)&&St(e.length)&&!!wt[we(e)]},Lt=kt,Et=Object.prototype,Pt=Et.hasOwnProperty,Tt=function(e,t){var o=ft(e),n=!o&&bt(e),r=!o&&!n&&jt(e),a=!o&&!n&&!r&&Lt(e),c=o||n||r||a,i=c?lt(e.length,String):[],l=i.length;for(var p in e)(t||Pt.call(e,p))&&!(c&&("length"==p||r&&("offset"==p||"parent"==p)||a&&("buffer"==p||"byteLength"==p||"byteOffset"==p)||xt(p,l)))&&i.push(p);return i},zt=Object.prototype,Ft=function(e){var t=e&&e.constructor,o="function"==typeof t&&t.prototype||zt;return e===o},It=function(e,t){return function(o){return e(t(o))}},Ut=It(Object.keys,Object),Nt=Object.prototype,Mt=Nt.hasOwnProperty,Bt=function(e){if(!Ft(e))return Ut(e);var t=[];for(var o in Object(e))Mt.call(e,o)&&"constructor"!=o&&t.push(o);return t},Gt=function(e){return null!=e&&St(e.length)&&!ve(e)},Dt=function(e){return Gt(e)?Tt(e):Bt(e)},Ct=function(e,t){return e&&it(t,Dt(t),e)},Rt=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t},Vt=Object.prototype,Wt=Vt.hasOwnProperty,$t=function(e){if(!Ae(e))return Rt(e);var t=Ft(e),o=[];for(var n in e)("constructor"!=n||!t&&Wt.call(e,n))&&o.push(n);return o},qt=function(e){return Gt(e)?Tt(e,!0):$t(e)},Ht=function(e,t){return e&&it(t,qt(t),e)},Yt=o(function(e,t){var o=t&&!t.nodeType&&t,n=o&&!0&&e&&!e.nodeType&&e,r=n&&n.exports===o,a=r?se.Buffer:void 0,c=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,n=c?c(o):new e.constructor(o);return e.copy(n),n}}),Xt=function(e,t){var o=-1,n=e.length;for(t||(t=Array(n));++o<n;)t[o]=e[o];return t},Qt=function(e,t){for(var o=-1,n=null==e?0:e.length,r=0,a=[];++o<n;){var c=e[o];t(c,o,e)&&(a[r++]=c)}return a},Zt=function(){return[]},Jt=Object.prototype,Kt=Jt.propertyIsEnumerable,eo=Object.getOwnPropertySymbols,to=eo?function(e){return null==e?[]:(e=Object(e),Qt(eo(e),function(t){return Kt.call(e,t)}))}:Zt,oo=to,no=function(e,t){return it(e,oo(e),t)},ro=function(e,t){for(var o=-1,n=t.length,r=e.length;++o<n;)e[r+o]=t[o];return e},ao=It(Object.getPrototypeOf,Object),co=ao,io=Object.getOwnPropertySymbols,lo=io?function(e){for(var t=[];e;)ro(t,oo(e)),e=co(e);return t}:Zt,po=lo,so=function(e,t){return it(e,po(e),t)},yo=function(e,t,o){var n=t(e);return ft(e)?n:ro(n,o(e))},uo=function(e){return yo(e,Dt,oo)},ho=function(e){return yo(e,qt,po)},bo=Ce(se,"DataView"),go=bo,fo=Ce(se,"Promise"),_o=fo,jo=Ce(se,"Set"),mo=jo,xo=Ce(se,"WeakMap"),So=xo,wo="[object Map]",Ao="[object Promise]",vo="[object Set]",Oo="[object WeakMap]",ko="[object DataView]",Lo=Te(go),Eo=Te(Ve),Po=Te(_o),To=Te(mo),zo=Te(So),Fo=we;(go&&Fo(new go(new ArrayBuffer(1)))!=ko||Ve&&Fo(new Ve)!=wo||_o&&Fo(_o.resolve())!=Ao||mo&&Fo(new mo)!=vo||So&&Fo(new So)!=Oo)&&(Fo=function(e){var t=we(e),o=t=="[object Object]"?e.constructor:void 0,n=o?Te(o):"";if(n)switch(n){case Lo:return ko;case Eo:return wo;case Po:return Ao;case To:return vo;case zo:return Oo;}return t});var Io=Fo,Uo=Object.prototype,No=Uo.hasOwnProperty,Mo=function(e){var t=e.length,o=new e.constructor(t);return t&&"string"==typeof e[0]&&No.call(e,"index")&&(o.index=e.index,o.input=e.input),o},Bo=se.Uint8Array,Go=Bo,Do=function(e){var t=new e.constructor(e.byteLength);return new Go(t).set(new Go(e)),t},Co=function(e,t){var o=t?Do(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)},Ro=/\w*$/,Vo=function(e){var t=new e.constructor(e.source,Ro.exec(e));return t.lastIndex=e.lastIndex,t},Wo=ue?ue.prototype:void 0,$o=Wo?Wo.valueOf:void 0,qo=function(e){return $o?Object($o.call(e)):{}},Ho=function(e,t){var o=t?Do(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)},Yo=function(e,t,o){var n=e.constructor;return"[object ArrayBuffer]"===t?Do(e):"[object Boolean]"===t||"[object Date]"===t?new n(+e):"[object DataView]"===t?Co(e,o):"[object Float32Array]"===t||"[object Float64Array]"===t||"[object Int8Array]"===t||"[object Int16Array]"===t||"[object Int32Array]"===t||"[object Uint8Array]"===t||"[object Uint8ClampedArray]"===t||"[object Uint16Array]"===t||"[object Uint32Array]"===t?Ho(e,o):"[object Map]"===t?new n:"[object Number]"===t||"[object String]"===t?new n(e):"[object RegExp]"===t?Vo(e):"[object Set]"===t?new n:"[object Symbol]"===t?qo(e):void 0},Xo=Object.create,Qo=function(){function e(){}return function(t){if(!Ae(t))return{};if(Xo)return Xo(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}(),Zo=function(e){return"function"!=typeof e.constructor||Ft(e)?{}:Qo(co(e))},Jo=vt&&vt.isMap,Ko=Jo?At(Jo):function(e){return pt(e)&&Io(e)=="[object Map]"},en=Ko,tn=vt&&vt.isSet,on=tn?At(tn):function(e){return pt(e)&&Io(e)=="[object Set]"},nn=on,rn={};rn["[object Arguments]"]=rn["[object Array]"]=rn["[object ArrayBuffer]"]=rn["[object DataView]"]=rn["[object Boolean]"]=rn["[object Date]"]=rn["[object Float32Array]"]=rn["[object Float64Array]"]=rn["[object Int8Array]"]=rn["[object Int16Array]"]=rn["[object Int32Array]"]=rn["[object Map]"]=rn["[object Number]"]=rn["[object Object]"]=rn["[object RegExp]"]=rn["[object Set]"]=rn["[object String]"]=rn["[object Symbol]"]=rn["[object Uint8Array]"]=rn["[object Uint8ClampedArray]"]=rn["[object Uint16Array]"]=rn["[object Uint32Array]"]=!0,rn["[object Error]"]=rn["[object Function]"]=rn["[object WeakMap]"]=!1;var an=function(e){return b(e,5)},cn=g,ln=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pn=/^\w*$/,dn=f;_.Cache=Je;var sn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yn=/\\(\\)?/g,un=function(e){var t=_(e,function(e){return 500===o.size&&o.clear(),e}),o=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(sn,function(e,o,n,r){t.push(n?r.replace(yn,"$1"):o||e)}),t}),hn=function(e,t){for(var o=-1,n=null==e?0:e.length,r=Array(n);++o<n;)r[o]=t(e[o],o,e);return r},bn=1/0,gn=ue?ue.prototype:void 0,fn=gn?gn.toString:void 0,_n=function(e){return null==e?"":j(e)},jn=function(e,t){return ft(e)?e:dn(e,t)?[e]:un(_n(e))},mn=function(e){if("string"==typeof e||cn(e))return e;var t=e+"";return"0"==t&&1/e==-(1/0)?"-0":t},xn=function(e,t){t=jn(t,e);for(var o=0,n=t.length;null!=e&&o<n;)e=e[mn(t[o++])];return o&&o==n?e:void 0},Sn=function(e,t,o){var n=null==e?void 0:xn(e,t);return n===void 0?o:n};m.prototype.add=m.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},m.prototype.has=function(e){return this.__data__.has(e)};var wn=m,An=function(e,t){for(var o=-1,n=null==e?0:e.length;++o<n;)if(t(e[o],o,e))return!0;return!1},vn=function(e,t){return e.has(t)},On=function(e,t,o,n,r,a){var c=1&o,i=e.length,l=t.length;if(i!=l&&!(c&&l>i))return!1;var p=a.get(e);if(p&&a.get(t))return p==t;var d=-1,s=!0,y=2&o?new wn:void 0;for(a.set(e,t),a.set(t,e);++d<i;){var u=e[d],h=t[d];if(n)var b=c?n(h,u,d,t,e,a):n(u,h,d,e,t,a);if(void 0!==b){if(b)continue;s=!1;break}if(y){if(!An(t,function(e,t){if(!vn(y,t)&&(u===e||r(u,e,o,n,a)))return y.push(t)})){s=!1;break}}else if(!(u===h||r(u,h,o,n,a))){s=!1;break}}return a["delete"](e),a["delete"](t),s},kn=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e,n){o[++t]=[n,e]}),o},Ln=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o},En=ue?ue.prototype:void 0,Pn=En?En.valueOf:void 0,Tn=function(e,t,o,n,r,a,c){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!!(e.byteLength==t.byteLength&&a(new Go(e),new Go(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return oe(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var i=kn;case"[object Set]":var l=1&n;if(i||(i=Ln),e.size!=t.size&&!l)return!1;var p=c.get(e);if(p)return p==t;n|=2,c.set(e,t);var d=On(i(e),i(t),n,r,a,c);return c["delete"](e),d;case"[object Symbol]":if(Pn)return Pn.call(e)==Pn.call(t);}return!1},zn=Object.prototype,Fn=zn.hasOwnProperty,In=Object.prototype,Un=In.hasOwnProperty,Nn=function(e,t,o,n,r,a){var c=ft(e),i=ft(t),l=c?"[object Array]":Io(e),p=i?"[object Array]":Io(t);l="[object Arguments]"==l?"[object Object]":l,p="[object Arguments]"==p?"[object Object]":p;var d="[object Object]"==l,s="[object Object]"==p,y=l==p;if(y&&jt(e)){if(!jt(t))return!1;c=!0,d=!1}if(y&&!d)return a||(a=new Ke),c||Lt(e)?On(e,t,o,n,r,a):Tn(e,t,l,o,n,r,a);if(!(1&o)){var u=d&&Un.call(e,"__wrapped__"),h=s&&Un.call(t,"__wrapped__");if(u||h){var b=u?e.value():e,g=h?t.value():t;return a||(a=new Ke),r(b,g,o,n,a)}}return!!y&&(a||(a=new Ke),x(e,t,o,n,r,a))},Mn=S,Bn=function(e){return e===e&&!Ae(e)},Gn=function(e){for(var t=Dt(e),o=t.length;o--;){var n=t[o],r=e[n];t[o]=[n,r,Bn(r)]}return t},Dn=function(e,t){return function(o){return null!=o&&o[e]===t&&(t!==void 0||e in Object(o))}},Cn=function(e){var t=Gn(e);return 1==t.length&&t[0][2]?Dn(t[0][0],t[0][1]):function(o){return o===e||w(o,e,t)}},Rn=function(e,t,o){t=jn(t,e);for(var n,r=-1,a=t.length,c=!1;++r<a&&(n=mn(t[r]),!!(c=null!=e&&o(e,n)));)e=e[n];return c||++r!=a?c:(a=null==e?0:e.length,!!a&&St(a)&&xt(n,a)&&(ft(e)||bt(e)))},Vn=function(e,t){return null!=e&&Rn(e,t,A)},Wn=function(e,t){return dn(e)&&Bn(t)?Dn(mn(e),t):function(o){var n=Sn(o,e);return n===void 0&&n===t?Vn(o,e):Mn(t,n,3)}},$n=function(e){return e},qn=function(e){return function(t){return null==t?void 0:t[e]}},Hn=function(e){return function(t){return xn(t,e)}},Yn=function(e){return dn(e)?qn(mn(e)):Hn(e)},Xn=function(e,t,o,n){for(var r=e.length,a=o+(n?1:-1);n?a--:++a<r;)if(t(e[a],a,e))return a;return-1},Qn=function(e){return e!==e},Zn=function(e,t,o){for(var n=o-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1},Jn=function(e,t,o){return t===t?Zn(e,t,o):Xn(e,Qn,o)},Kn=function(e,t){var o=null==e?0:e.length;return!!o&&-1<Jn(e,t,0)},er=function(e,t,o){for(var n=-1,r=null==e?0:e.length;++n<r;)if(o(t,e[n]))return!0;return!1},tr=mo&&1/Ln(new mo([,-0]))[1]==1/0?function(e){return new mo(e)}:function(){},or=function(e,t,o){var n=-1,r=Kn,a=e.length,c=!0,i=[],l=i;if(o)c=!1,r=er;else if(a>=200){var p=t?null:tr(e);if(p)return Ln(p);c=!1,r=vn,l=new wn}else l=t?[]:i;outer:for(;++n<a;){var d=e[n],s=t?t(d):d;if(d=o||0!==d?d:0,c&&s===s){for(var y=l.length;y--;)if(l[y]===s)continue outer;t&&l.push(s),i.push(d)}else r(l,s,o)||(l!==i&&l.push(s),i.push(d))}return i},nr=function(e,t){return e&&e.length?or(e,v(t)):[]},rr=function(e,t){return Mn(e,t)},ar=function(e){return function(t,o,n){for(var r=-1,a=Object(t),c=n(t),i=c.length;i--;){var l=c[e?i:++r];if(!1===o(a[l],l,a))break}return t}}(),cr=function(e,t){return function(o,n){if(null==o)return o;if(!Gt(o))return e(o,n);for(var r=o.length,a=t?r:-1,c=Object(o);(t?a--:++a<r)&&!(!1===n(c[a],a,c)););return o}}(function(e,t){return e&&ar(e,t,Dt)}),ir=function(e){return"function"==typeof e?e:$n},lr=function(e,t){var o=ft(e)?et:cr;return o(e,ir(t))},pr=0/0,dr=/^\s+|\s+$/g,sr=/^[-+]0x[0-9a-f]+$/i,yr=/^0b[01]+$/i,ur=/^0o[0-7]+$/i,hr=parseInt,br=function(e){if("number"==typeof e)return e;if(cn(e))return pr;if(Ae(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ae(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(dr,"");var o=yr.test(e);return o||ur.test(e)?hr(e.slice(2),o?2:8):sr.test(e)?pr:+e},gr=1/0,fr=function(e){if(!e)return 0===e?e:0;if(e=br(e),e===gr||e===-gr){var t=0>e?-1:1;return 1.7976931348623157e+308*t}return e===e?e:0},_r=function(e){var t=fr(e),o=t%1;return t===t?o?t-o:t:0},jr=function(e){return"number"==typeof e&&e==_r(e)},mr=se.isFinite,xr=Math.min,Sr=function(e){var t=Math[e];return function(e,o){if(e=br(e),o=null==o?0:xr(_r(o),292),o&&mr(e)){var n=(_n(e)+"e").split("e"),r=t(n[0]+"e"+(+n[1]+o));return n=(_n(r)+"e").split("e"),+(n[0]+"e"+(+n[1]-o))}return t(e)}}("round"),wr=Sr;return function(t){function o(e){var o=O();return R(t.authenticate)?t.authenticate(e).then(function(e){o.resolve(e)}):o.resolve(!0),o}function n(){return r.apply(this,arguments)}function r(){return r=te(ee.mark(function e(n){var r,a,c,i,l;return ee.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=C(n,"token"),e.next=3,o(r);case 3:if(a=e.sent,!a){e.next=25;break}if(c=C(n,"func"),i=G(n,"input"),"getFuncs"!==c){e.next=15;break}if(!R(t.filterFuncs)){e.next=12;break}return e.next=11,t.filterFuncs(r,d);case 11:d=e.sent;case 12:n.output={sys:"sys",funcs:d},e.next=23;break;case 15:if(!Z(d,c)){e.next=22;break}return e.next=18,t.funcs[c](i);case 18:l=e.sent,n.output=l,e.next=23;break;case 22:n.output={err:"can not find: ".concat(c)};case 23:e.next=26;break;case 25:n.output={err:"can not authenticate token: ".concat(r)};case 26:return delete n.input,e.abrupt("return",JSON.stringify(n));case 28:case"end":return e.stop();}},e)})),r.apply(this,arguments)}function a(e){if(R(t.onClientChange)){var o=nr(e,"clientId");rr(p,o)||(p=o,t.onClientChange(p,t))}}function c(){return i.apply(this,arguments)}function i(){return i=te(ee.mark(function o(){var n;return ee.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n=e.server({port:t.port,routes:{cors:!0}}),n.route(s),lr(t.routes,function(e){n.route(e)}),o.next=5,n.start();case 5:console.log("Server running at: ".concat(n.info.uri));case 6:case"end":return o.stop();}},o)})),i.apply(this,arguments)}var l=[],p=[];t=an(t),t.port||(t.port=8080),t.apiName||(t.apiName="api"),t.routes||(t.routes=[]);var d=[];M(t,"funcs")&&(d=Dt(t.funcs));var s={path:"/"+t.apiName,method:"POST",handler:function(e){var t=O(),o=U(),r=Sn(e.payload,"clientId"),c={headers:e.headers,info:e.info};l.push({clientId:r,connId:o,data:c}),a(l);var i=e.payload;return n(i).then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){l=l.filter(function(e){return e.connId!==o}),a(l)}),t}};t.serverHapi?t.serverHapi.route(s):c()}});
//# sourceMappingURL=ht-server.umd.js.map
