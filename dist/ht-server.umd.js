/*!
 * ht-server v1.0.1
 * (c) 2018-2019 yuda-lyu(semisphere)
 * Released under the MIT License.
 */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@hapi/hapi")):"function"==typeof define&&define.amd?define(["@hapi/hapi"],t):(e=e||self,e["ht-server"]=t(e["@hapi/hapi"]))})(this,function(e){'use strict';function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e,t,o,r,n,a,c){try{var i=e[a](c),p=i.value}catch(e){return void o(e)}i.done?t(p):Promise.resolve(p).then(r,n)}function n(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}function a(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_e&&_e in Object(e)?he(e):fe(e)}function c(e){var o=t(e);return null!=e&&("object"==o||"function"==o)}function i(e){return!!ve&&ve in e}function p(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}function l(e){var o=t(e);return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==e:null===e}function d(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}function s(e){var t=this.__data__=new oe(e);this.size=t.size}function y(e,t,o){var r=e[t];tt.call(e,t)&&J(r,o)&&(o!==void 0||t in e)||Ke(e,t,o)}function u(e){return null!=e&&"object"==t(e)}function h(e,o){var r=t(e);return o=null==o?9007199254740991:o,!!o&&("number"==r||"symbol"!=r&&gt.test(e))&&-1<e&&0==e%1&&e<o}function g(e,t,o,r,n,a){var c,i=1&t,p=2&t;if(o&&(c=n?o(e,r,n,a):o(e)),void 0!==c)return c;if(!me(e))return e;var l=yt(e);if(!l){var d=Lo(e),s="[object Function]"==d||"[object GeneratorFunction]"==d;if(ht(e))return Dt(e,i);if("[object Object]"!=d&&"[object Arguments]"!=d&&(!s||n)){if(!Zo[d])return n?e:{};c=Do(e,d,i)}else if(c=p||s?{}:Wo(e),!i)return p?ro(e,Bt(c,e)):Qt(e,It(c,e))}else if(c=To(e),!i)return Rt(e,c);a||(a=new Xe);var y=a.get(e);if(y)return y;if(a.set(e,c),Qo(e))return e.forEach(function(r){c.add(g(r,t,o,r,e,a))}),c;if(Ho(e))return e.forEach(function(r,n){c.set(n,g(r,t,o,n,e,a))}),c;var u=4&t?p?co:ao:p?keysIn:zt,h=l?void 0:u(e);return Qe(h||e,function(r,n){h&&(n=r,r=e[n]),ot(c,n,g(r,t,o,n,e,a))}),c}function b(){var e,t,o=new Promise(function(){e=arguments[0],t=arguments[1]});return o.resolve=e,o.reject=t,o}function f(e){return"symbol"==t(e)||at(e)&&je(e)=="[object Symbol]"}function _(e){var t=Object.prototype.toString.call(e);return"[object String]"===t}function m(e){return!!(_(e)&&""!==e)}function x(e){var t=Object.prototype.toString.call(e);return"[object Number]"===t}function S(e){var t=!1;return m(e)?t=!isNaN(+e):x(e)&&(t=!0),t}function w(e){if(!S(e))return 0;var t=pr(e);return t}function A(e){return!!S(e)&&(e=w(e),dr(e))}function O(e){if("string"==typeof e)return e;if(yt(e))return sr(e,O)+"";if(Ko(e))return hr?hr.call(e):"";var t=e+"";return"0"==t&&1/e==-yr?"-0":t}function L(e){if(!S(e))return 0;e=w(e);var t=_r(e);return"0"===t+""?0:t}function k(e){if(!A(e))return!1;var t=0<L(e);return t}function E(){var e,t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:32,o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n=[],a=o.length;if(k(t))for(e=0;e<t;e++)n[e]=o[0|Math.random()*a];else if("rfc4122"===t){n[8]=n[13]=n[18]=n[23]="-",n[14]="4";var c;for(e=0;36>e;e++)n[e]||(c=0|16*Math.random(),n[e]=o[19===e?8|3&c:c])}else return"";var p=n.join("");return p}function T(e){var t=Object.prototype.toString.call(e);return"[object Object]"===t}function P(e,t){return!!T(e)&&!!m(t)&&t in e}function F(e,o){if(yt(e))return!1;var r=t(e);return!!("number"==r||"symbol"==r||"boolean"==r||null==e||Ko(e))||mr.test(e)||!jr.test(e)||null!=o&&e in Object(o)}function z(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var o=function o(){var r=arguments,n=t?t.apply(this,r):r[0],a=o.cache;if(a.has(n))return a.get(n);var c=e.apply(this,r);return o.cache=a.set(n,c)||a,c};return o.cache=new(z.Cache||Ye),o}function I(e){if(T(e)){for(var t in e)return!0;return!1}return!1}function U(e,t){return I(e)?m(t)?Lr(e,t,""):"":""}function N(e){if(!m(e)&&!S(e))return"";return e+""}function C(e,t){var o=U(e,t);return o=N(o),o}function M(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function G(e){var t=Object.prototype.toString.call(e);return"[object Array]"===t}function B(e){var t=Object.prototype.toString.call(e);return"[object Undefined]"===t}function D(e){var t=Object.prototype.toString.call(e);return"[object Null]"===t}function R(e){if(T(e)){for(var t in e)return!1;return!0}return!1}function V(e){return!!(_(e)&&""===e)}function W(e){return!!G(e)&&0===e.length}function $(e){return!!B(e)||!!D(e)||!!R(e)||!!V(e)||!!W(e)}function q(e){return!!G(e)&&0!==e.length&&!(1===e.length&&$(e[0]))}function H(e,t){if(m(e))e=[e];else if(q(e));else return!1;if(m(t))t=[t];else if(q(t));else return!1;for(var o=0;o<e.length;o++)for(var r=0;r<t.length;r++)if(e[o]===t[r])return!0;return!1}e=e&&e.hasOwnProperty("default")?e["default"]:e;var Y="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,X=o(function(e){var o=function(e){function o(e,t,o,r){var a=t&&t.prototype instanceof n?t:n,c=Object.create(a.prototype),i=new u(r||[]);return c._invoke=l(e,o,i),c}function r(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}function n(){}function a(){}function c(){}function i(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function p(e){function o(n,a,c,i){var p=r(e[n],e,a);if("throw"===p.type)i(p.arg);else{var l=p.arg,d=l.value;return d&&"object"===t(d)&&_.call(d,"__await")?Promise.resolve(d.__await).then(function(e){o("next",e,c,i)},function(e){o("throw",e,c,i)}):Promise.resolve(d).then(function(e){l.value=e,c(l)},function(e){return o("throw",e,c,i)})}}function n(e,t){function r(){return new Promise(function(r,n){o(e,t,r,n)})}return a=a?a.then(r,r):r()}var a;this._invoke=n}function l(e,t,o){var n="suspendedStart";return function(a,c){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw c;return g()}for(o.method=a,o.arg=c;;){var i=o.delegate;if(i){var p=d(i,o);if(p){if(p===w)continue;return p}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===n)throw n="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n="executing";var l=r(e,t,o);if("normal"===l.type){if(n=o.done?"completed":"suspendedYield",l.arg===w)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(n="completed",o.method="throw",o.arg=l.arg)}}}function d(e,t){var o=e.iterator[t.method];if(o===b){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=b,d(e,t),"throw"===t.method))return w;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var n=r(o,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,w;var a=n.arg;if(!a)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w;if(a.done)t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=b);else return a;return t.delegate=null,w}function s(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function u(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(s,this),this.reset(!0)}function h(e){if(e){var t=e[m];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(_.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=b,t.done=!0,t};return r.next=r}}return{next:g}}function g(){return{value:b,done:!0}}var b,f=Object.prototype,_=f.hasOwnProperty,j="function"==typeof Symbol?Symbol:{},m=j.iterator||"@@iterator",x=j.asyncIterator||"@@asyncIterator",S=j.toStringTag||"@@toStringTag";e.wrap=o;var w={},v={};v[m]=function(){return this};var A=Object.getPrototypeOf,O=A&&A(A(h([])));O&&O!==f&&_.call(O,m)&&(v=O);var L=c.prototype=n.prototype=Object.create(v);return a.prototype=L.constructor=c,c.constructor=a,c[S]=a.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,!(S in e)&&(e[S]="GeneratorFunction")),e.prototype=Object.create(L),e},e.awrap=function(e){return{__await:e}},i(p.prototype),p.prototype[x]=function(){return this},e.AsyncIterator=p,e.async=function(t,r,n,a){var c=new p(o(t,r,n,a));return e.isGeneratorFunction(r)?c:c.next().then(function(e){return e.done?e.value:c.next()})},i(L),L[S]="Generator",L[m]=function(){return this},L.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var r=t.pop();if(r in e)return o.value=r,o.done=!1,o}return o.done=!0,o}},e.values=h,u.prototype={constructor:u,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=b,this.done=!1,this.delegate=null,this.method="next",this.arg=b,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&_.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=b)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,o.next=t,r&&(o.method="next",o.arg=b),!!r}if(this.done)throw e;for(var o=this,r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var c=_.call(n,"catchLoc"),p=_.call(n,"finallyLoc");if(c&&p){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(c){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);}else if(!p)throw new Error("try statement without catch or finally");else if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}},abrupt:function(e,t){for(var o,r=this.tryEntries.length-1;0<=r;--r)if(o=this.tryEntries[r],o.tryLoc<=this.prev&&_.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,w):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),y(t),w},catch:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.tryLoc===e){var r=t.completion;if("throw"===r.type){var n=r.arg;y(t)}return n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:h(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=b),w}},e}(e.exports);try{regeneratorRuntime=o}catch(e){Function("r","regeneratorRuntime = r")(o)}}),Q=X,Z=function(e){return function(){var t=this,o=arguments;return new Promise(function(n,a){function c(e){r(p,n,a,c,i,"next",e)}function i(e){r(p,n,a,c,i,"throw",e)}var p=e.apply(t,o);c(void 0)})}},J=function(e,t){return e===t||e!==e&&t!==t},K=function(e,t){for(var o=e.length;o--;)if(J(e[o][0],t))return o;return-1},ee=Array.prototype,te=ee.splice;n.prototype.clear=function(){this.__data__=[],this.size=0},n.prototype["delete"]=function(e){var t=this.__data__,o=K(t,e);if(0>o)return!1;var r=t.length-1;return o==r?t.pop():te.call(t,o,1),--this.size,!0},n.prototype.get=function(e){var t=this.__data__,o=K(t,e);return 0>o?void 0:t[o][1]},n.prototype.has=function(e){return-1<K(this.__data__,e)},n.prototype.set=function(e,t){var o=this.__data__,r=K(o,e);return 0>r?(++this.size,o.push([e,t])):o[r][1]=t,this};var oe=n,re="object"==t(Y)&&Y&&Y.Object===Object&&Y,ne=re,ae="object"==("undefined"==typeof self?"undefined":t(self))&&self&&self.Object===Object&&self,ce=ne||ae||Function("return this")(),ie=ce,pe=ie.Symbol,le=pe,de=Object.prototype,se=de.hasOwnProperty,ye=de.toString,ue=le?le.toStringTag:void 0,he=function(e){var t=se.call(e,ue),o=e[ue];try{e[ue]=void 0;var r=!0}catch(t){}var n=ye.call(e);return r&&(t?e[ue]=o:delete e[ue]),n},ge=Object.prototype,be=ge.toString,fe=function(e){return be.call(e)},_e=le?le.toStringTag:void 0,je=a,me=c,xe=function(e){if(!me(e))return!1;var t=je(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},Se=ie["__core-js_shared__"],we=Se,ve=function(){var e=/[^.]+$/.exec(we&&we.keys&&we.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ae=Function.prototype,Oe=Ae.toString,Le=function(e){if(null!=e){try{return Oe.call(e)}catch(t){}try{return e+""}catch(t){}}return""},ke=/[\\^$.*+?()[\]{}|]/g,Ee=/^\[object .+?Constructor\]$/,Te=Function.prototype,Pe=Object.prototype,Fe=Te.toString,ze=Pe.hasOwnProperty,Ie=RegExp("^"+Fe.call(ze).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ue=function(e){if(!me(e)||i(e))return!1;var t=xe(e)?Ie:Ee;return t.test(Le(e))},Ne=function(e,t){return null==e?void 0:e[t]},Ce=function(e,t){var o=Ne(e,t);return Ue(o)?o:void 0},Me=Ce(ie,"Map"),Ge=Me,Be=Ce(Object,"create"),De=Be,Re=Object.prototype,Ve=Re.hasOwnProperty,We=Object.prototype,$e=We.hasOwnProperty;p.prototype.clear=function(){this.__data__=De?De(null):{},this.size=0},p.prototype["delete"]=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},p.prototype.get=function(e){var t=this.__data__;if(De){var o=t[e];return o==="__lodash_hash_undefined__"?void 0:o}return Ve.call(t,e)?t[e]:void 0},p.prototype.has=function(e){var t=this.__data__;return De?t[e]!==void 0:$e.call(t,e)},p.prototype.set=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=De&&void 0===t?"__lodash_hash_undefined__":t,this};var qe=p,He=function(e,t){var o=e.__data__;return l(t)?o["string"==typeof t?"string":"hash"]:o.map};d.prototype.clear=function(){this.size=0,this.__data__={hash:new qe,map:new(Ge||oe),string:new qe}},d.prototype["delete"]=function(e){var t=He(this,e)["delete"](e);return this.size-=t?1:0,t},d.prototype.get=function(e){return He(this,e).get(e)},d.prototype.has=function(e){return He(this,e).has(e)},d.prototype.set=function(e,t){var o=He(this,e),r=o.size;return o.set(e,t),this.size+=o.size==r?0:1,this};var Ye=d;s.prototype.clear=function(){this.__data__=new oe,this.size=0},s.prototype["delete"]=function(e){var t=this.__data__,o=t["delete"](e);return this.size=t.size,o},s.prototype.get=function(e){return this.__data__.get(e)},s.prototype.has=function(e){return this.__data__.has(e)},s.prototype.set=function(e,t){var o=this.__data__;if(o instanceof oe){var r=o.__data__;if(!Ge||199>r.length)return r.push([e,t]),this.size=++o.size,this;o=this.__data__=new Ye(r)}return o.set(e,t),this.size=o.size,this};var Xe=s,Qe=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r&&!(!1===t(e[o],o,e)););return e},Ze=function(){try{var e=Ce(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Je=Ze,Ke=function(e,t,o){"__proto__"==t&&Je?Je(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o},et=Object.prototype,tt=et.hasOwnProperty,ot=y,rt=function(e,t,o,r){var n=!o;o||(o={});for(var a=-1,c=t.length;++a<c;){var i=t[a],p=r?r(o[i],e[i],i,o,e):void 0;p===void 0&&(p=e[i]),n?Ke(o,i,p):ot(o,i,p)}return o},nt=function(e,t){for(var o=-1,r=Array(e);++o<e;)r[o]=t(o);return r},at=u,ct=function(e){return at(e)&&je(e)=="[object Arguments]"},it=Object.prototype,pt=it.hasOwnProperty,lt=it.propertyIsEnumerable,dt=ct(function(){return arguments}())?ct:function(e){return at(e)&&pt.call(e,"callee")&&!lt.call(e,"callee")},st=Array.isArray,yt=st,ut=function(){return!1},ht=o(function(e,t){var o=t&&!t.nodeType&&t,r=o&&!0&&e&&!e.nodeType&&e,n=r&&r.exports===o,a=n?ie.Buffer:void 0,c=a?a.isBuffer:void 0;e.exports=c||ut}),gt=/^(?:0|[1-9]\d*)$/,bt=function(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991},ft={};ft["[object Float32Array]"]=ft["[object Float64Array]"]=ft["[object Int8Array]"]=ft["[object Int16Array]"]=ft["[object Int32Array]"]=ft["[object Uint8Array]"]=ft["[object Uint8ClampedArray]"]=ft["[object Uint16Array]"]=ft["[object Uint32Array]"]=!0,ft["[object Arguments]"]=ft["[object Array]"]=ft["[object ArrayBuffer]"]=ft["[object Boolean]"]=ft["[object DataView]"]=ft["[object Date]"]=ft["[object Error]"]=ft["[object Function]"]=ft["[object Map]"]=ft["[object Number]"]=ft["[object Object]"]=ft["[object RegExp]"]=ft["[object Set]"]=ft["[object String]"]=ft["[object WeakMap]"]=!1;var _t=function(e){return function(t){return e(t)}},jt=o(function(e,t){var o=t&&!t.nodeType&&t,r=o&&!0&&e&&!e.nodeType&&e,n=r&&r.exports===o,a=n&&ne.process,c=function(){try{var e=r&&r.require&&r.require("util").types;return e?e:a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=c}),mt=jt&&jt.isTypedArray,xt=mt?_t(mt):function(e){return at(e)&&bt(e.length)&&!!ft[je(e)]},St=Object.prototype,wt=St.hasOwnProperty,vt=function(e,t){var o=yt(e),r=!o&&dt(e),n=!o&&!r&&ht(e),a=!o&&!r&&!n&&xt(e),c=o||r||n||a,i=c?nt(e.length,String):[],p=i.length;for(var l in e)(t||wt.call(e,l))&&!(c&&("length"==l||n&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||h(l,p)))&&i.push(l);return i},At=Object.prototype,Ot=function(e){var t=e&&e.constructor,o="function"==typeof t&&t.prototype||At;return e===o},Lt=function(e,t){return function(o){return e(t(o))}},kt=Lt(Object.keys,Object),Et=Object.prototype,Tt=Et.hasOwnProperty,Pt=function(e){if(!Ot(e))return kt(e);var t=[];for(var o in Object(e))Tt.call(e,o)&&"constructor"!=o&&t.push(o);return t},Ft=function(e){return null!=e&&bt(e.length)&&!xe(e)},zt=function(e){return Ft(e)?vt(e):Pt(e)},It=function(e,t){return e&&rt(t,zt(t),e)},Ut=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t},Nt=Object.prototype,Ct=Nt.hasOwnProperty,Mt=function(e){if(!me(e))return Ut(e);var t=Ot(e),o=[];for(var r in e)("constructor"!=r||!t&&Ct.call(e,r))&&o.push(r);return o},Gt=function(e){return Ft(e)?vt(e,!0):Mt(e)},Bt=function(e,t){return e&&rt(t,Gt(t),e)},Dt=o(function(e,t){var o=t&&!t.nodeType&&t,r=o&&!0&&e&&!e.nodeType&&e,n=r&&r.exports===o,a=n?ie.Buffer:void 0,c=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,r=c?c(o):new e.constructor(o);return e.copy(r),r}}),Rt=function(e,t){var o=-1,r=e.length;for(t||(t=Array(r));++o<r;)t[o]=e[o];return t},Vt=function(e,t){for(var o=-1,r=null==e?0:e.length,n=0,a=[];++o<r;){var c=e[o];t(c,o,e)&&(a[n++]=c)}return a},Wt=function(){return[]},$t=Object.prototype,qt=$t.propertyIsEnumerable,Ht=Object.getOwnPropertySymbols,Yt=Ht?function(e){return null==e?[]:(e=Object(e),Vt(Ht(e),function(t){return qt.call(e,t)}))}:Wt,Xt=Yt,Qt=function(e,t){return rt(e,Xt(e),t)},Zt=function(e,t){for(var o=-1,r=t.length,n=e.length;++o<r;)e[n+o]=t[o];return e},Jt=Lt(Object.getPrototypeOf,Object),Kt=Jt,eo=Object.getOwnPropertySymbols,to=eo?function(e){for(var t=[];e;)Zt(t,Xt(e)),e=Kt(e);return t}:Wt,oo=to,ro=function(e,t){return rt(e,oo(e),t)},no=function(e,t,o){var r=t(e);return yt(e)?r:Zt(r,o(e))},ao=function(e){return no(e,zt,Xt)},co=function(e){return no(e,Gt,oo)},io=Ce(ie,"DataView"),po=io,lo=Ce(ie,"Promise"),so=lo,yo=Ce(ie,"Set"),uo=yo,ho=Ce(ie,"WeakMap"),go=ho,bo="[object Map]",fo="[object Promise]",_o="[object Set]",jo="[object WeakMap]",mo="[object DataView]",xo=Le(po),So=Le(Ge),wo=Le(so),vo=Le(uo),Ao=Le(go),Oo=je;(po&&Oo(new po(new ArrayBuffer(1)))!=mo||Ge&&Oo(new Ge)!=bo||so&&Oo(so.resolve())!=fo||uo&&Oo(new uo)!=_o||go&&Oo(new go)!=jo)&&(Oo=function(e){var t=je(e),o=t=="[object Object]"?e.constructor:void 0,r=o?Le(o):"";if(r)switch(r){case xo:return mo;case So:return bo;case wo:return fo;case vo:return _o;case Ao:return jo;}return t});var Lo=Oo,ko=Object.prototype,Eo=ko.hasOwnProperty,To=function(e){var t=e.length,o=new e.constructor(t);return t&&"string"==typeof e[0]&&Eo.call(e,"index")&&(o.index=e.index,o.input=e.input),o},Po=ie.Uint8Array,Fo=Po,zo=function(e){var t=new e.constructor(e.byteLength);return new Fo(t).set(new Fo(e)),t},Io=function(e,t){var o=t?zo(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)},Uo=/\w*$/,No=function(e){var t=new e.constructor(e.source,Uo.exec(e));return t.lastIndex=e.lastIndex,t},Co=le?le.prototype:void 0,Mo=Co?Co.valueOf:void 0,Go=function(e){return Mo?Object(Mo.call(e)):{}},Bo=function(e,t){var o=t?zo(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)},Do=function(e,t,o){var r=e.constructor;return"[object ArrayBuffer]"===t?zo(e):"[object Boolean]"===t||"[object Date]"===t?new r(+e):"[object DataView]"===t?Io(e,o):"[object Float32Array]"===t||"[object Float64Array]"===t||"[object Int8Array]"===t||"[object Int16Array]"===t||"[object Int32Array]"===t||"[object Uint8Array]"===t||"[object Uint8ClampedArray]"===t||"[object Uint16Array]"===t||"[object Uint32Array]"===t?Bo(e,o):"[object Map]"===t?new r:"[object Number]"===t||"[object String]"===t?new r(e):"[object RegExp]"===t?No(e):"[object Set]"===t?new r:"[object Symbol]"===t?Go(e):void 0},Ro=Object.create,Vo=function(){function e(){}return function(t){if(!me(t))return{};if(Ro)return Ro(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}(),Wo=function(e){return"function"!=typeof e.constructor||Ot(e)?{}:Vo(Kt(e))},$o=jt&&jt.isMap,qo=$o?_t($o):function(e){return at(e)&&Lo(e)=="[object Map]"},Ho=qo,Yo=jt&&jt.isSet,Xo=Yo?_t(Yo):function(e){return at(e)&&Lo(e)=="[object Set]"},Qo=Xo,Zo={};Zo["[object Arguments]"]=Zo["[object Array]"]=Zo["[object ArrayBuffer]"]=Zo["[object DataView]"]=Zo["[object Boolean]"]=Zo["[object Date]"]=Zo["[object Float32Array]"]=Zo["[object Float64Array]"]=Zo["[object Int8Array]"]=Zo["[object Int16Array]"]=Zo["[object Int32Array]"]=Zo["[object Map]"]=Zo["[object Number]"]=Zo["[object Object]"]=Zo["[object RegExp]"]=Zo["[object Set]"]=Zo["[object String]"]=Zo["[object Symbol]"]=Zo["[object Uint8Array]"]=Zo["[object Uint8ClampedArray]"]=Zo["[object Uint16Array]"]=Zo["[object Uint32Array]"]=!0,Zo["[object Error]"]=Zo["[object Function]"]=Zo["[object WeakMap]"]=!1;var Jo=function(e){return g(e,5)},Ko=f,er=0/0,tr=/^\s+|\s+$/g,or=/^[-+]0x[0-9a-f]+$/i,rr=/^0b[01]+$/i,nr=/^0o[0-7]+$/i,ar=parseInt,cr=function(e){if("number"==typeof e)return e;if(Ko(e))return er;if(me(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=me(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(tr,"");var o=rr.test(e);return o||nr.test(e)?ar(e.slice(2),o?2:8):or.test(e)?er:+e},ir=1/0,pr=function(e){if(!e)return 0===e?e:0;if(e=cr(e),e===ir||e===-ir){var t=0>e?-1:1;return 1.7976931348623157e+308*t}return e===e?e:0},lr=function(e){var t=pr(e),o=t%1;return t===t?o?t-o:t:0},dr=function(e){return"number"==typeof e&&e==lr(e)},sr=function(e,t){for(var o=-1,r=null==e?0:e.length,n=Array(r);++o<r;)n[o]=t(e[o],o,e);return n},yr=1/0,ur=le?le.prototype:void 0,hr=ur?ur.toString:void 0,gr=function(e){return null==e?"":O(e)},br=Math.min,fr=function(e){var t=Math[e];return function(e,o){if(e=cr(e),o=null==o?0:br(lr(o),292),o){var r=(gr(e)+"e").split("e"),n=t(r[0]+"e"+(+r[1]+o));return r=(gr(n)+"e").split("e"),+(r[0]+"e"+(+r[1]-o))}return t(e)}}("round"),_r=fr,jr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mr=/^\w*$/;z.Cache=Ye;var xr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sr=/\\(\\)?/g,wr=function(e){var t=z(e,function(e){return 500===o.size&&o.clear(),e}),o=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(xr,function(e,o,r,n){t.push(r?n.replace(Sr,"$1"):o||e)}),t}),vr=function(e,t){return yt(e)?e:F(e,t)?[e]:wr(gr(e))},Ar=function(e){if("string"==typeof e||Ko(e))return e;var t=e+"";return"0"==t&&1/e==-(1/0)?"-0":t},Or=function(e,t){t=vr(t,e);for(var o=0,r=t.length;null!=e&&o<r;)e=e[Ar(t[o++])];return o&&o==r?e:void 0},Lr=function(e,t,o){var r=null==e?void 0:Or(e,t);return r===void 0?o:r};return function(t){function o(e){var o=b();return M(t.authenticate)?t.authenticate(e).then(function(e){o.resolve(e)}):o.resolve(!0),o}function r(){return n.apply(this,arguments)}function n(){return n=Z(Q.mark(function e(r){var n,a,c,i,l;return Q.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Server[port:".concat(t.port,"][api:").concat(t.apiName,"]: "),r),n=C(r,"token"),e.next=4,o(n);case 4:if(a=e.sent,!a){e.next=26;break}if(c=C(r,"func"),i=U(r,"input"),"getFuncs"!==c){e.next=16;break}if(!M(t.filterFuncs)){e.next=13;break}return e.next=12,t.filterFuncs(n,p);case 12:p=e.sent;case 13:r={output:{sys:"sys",funcs:p}},e.next=24;break;case 16:if(!H(p,c)){e.next=23;break}return e.next=19,t.funcs[c](i);case 19:l=e.sent,r.output=l,e.next=24;break;case 23:r.output={err:"can not find: ".concat(c)};case 24:e.next=27;break;case 26:r.output={err:"can not authenticate token: ".concat(n)};case 27:return e.abrupt("return",JSON.stringify(r));case 28:case"end":return e.stop();}},e)})),n.apply(this,arguments)}function a(){return c.apply(this,arguments)}function c(){return c=Z(Q.mark(function o(){var r;return Q.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r=e.server({port:t.port,routes:{cors:!0}}),r.route(l),o.next=4,r.start();case 4:console.log("Server running at: ".concat(r.info.uri));case 5:case"end":return o.stop();}},o)})),c.apply(this,arguments)}var i=[];t=Jo(t),t.port||(t.port=8080),t.apiName||(t.apiName="api");var p=[];P(t,"funcs")&&(p=zt(t.funcs));var l={path:"/"+t.apiName,method:"POST",handler:function(e){var o=b(),n=E();i.push({id:n,data:e}),console.log("push",n),M(t.onClientChange)&&t.onClientChange(i,t);var a=e.payload;return r(a).then(function(e){o.resolve(e)})["catch"](function(e){o.reject(e)})["finally"](function(){console.log("remove",n),i=i.filter(function(e){return e.id!==n}),M(t.onClientChange)&&t.onClientChange(i,t)}),o}};t.serverHapi?t.serverHapi.route(l):a()}});
//# sourceMappingURL=ht-server.umd.js.map
